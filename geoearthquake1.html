<!DOCTYPE html>
<html>
<head>
    <title>Plate Subduction Types Simulation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        canvas {
            width: 100%;
            border: 1px solid #ccc;
            margin: 10px 0;
        }
        .controls {
            margin: 20px 0;
            padding: 10px;
            background: #f8f8f8;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background: #4CAF50;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        .info {
            margin: 10px 0;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 5px;
        }
        .legend {
            margin-top: 10px;
            padding: 10px;
            background: #fff3e0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Plate Subduction Types Simulation</h1>
        <div class="controls">
            <button onclick="setSimulationType('oceanic-continental')">Oceanic-Continental</button>
            <button onclick="setSimulationType('oceanic-oceanic')">Oceanic-Oceanic</button>
            <button onclick="setSimulationType('continental-continental')">Continental-Continental</button>
        </div>
        <canvas id="simulationCanvas" height="400"></canvas>
        <div id="info" class="info"></div>
        <div class="legend">
            <strong>Legend:</strong>
            <div>â†’ Plate Movement Direction</div>
            <div>âš¡ Stress Build-up Points</div>
            <div>ðŸ”´ Earthquake Events</div>
            <div>â†‘ Compression Forces</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');
        let currentType = 'oceanic-continental';
        let animationFrame;
        let time = 0;
        let stressPoints = [];
        let earthquakes = [];

        // Resize canvas to be responsive
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = 400;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Colors and styles
        const colors = {
            oceanicPlate: '#2196F3',
            continentalPlate: '#795548',
            magma: '#FF5722',
            earthquake: '#FF0000',
            water: '#B3E5FC',
            mountain: '#8D6E63',
            force: '#FF9800',
            stress: '#FFD700',
            text: '#000000'
        };

        // Information for each type
        const info = {
            'oceanic-continental': {
                title: "Oceanic-Continental Subduction",
                example: "Example: Nazca Plate subducting beneath South American Plate",
                features: "Features: Peru-Chile Trench, Andes Mountains, frequent earthquakes",
                forceDescription: "Denser oceanic plate is pulled down by gravity, creating friction and stress"
            },
            'oceanic-oceanic': {
                title: "Oceanic-Oceanic Subduction",
                example: "Example: Pacific Plate subducting beneath Philippine Plate",
                features: "Features: Japan Trench, Japanese Archipelago, earthquakes and tsunamis",
                forceDescription: "Both plates are oceanic, but age difference causes one to subduct"
            },
            'continental-continental': {
                title: "Continental-Continental Collision",
                example: "Example: Indian Plate colliding with Eurasian Plate",
                features: "Features: Himalayas, intense deformation, frequent earthquakes",
                forceDescription: "Neither plate can subduct, resulting in intense compression and uplift"
            }
        };

        function setSimulationType(type) {
            currentType = type;
            time = 0;
            stressPoints = [];
            earthquakes = [];
            updateInfo();
        }

        function updateInfo() {
            const infoDiv = document.getElementById('info');
            const currentInfo = info[currentType];
            infoDiv.innerHTML = `
                <h3>${currentInfo.title}</h3>
                <p>${currentInfo.example}</p>
                <p>${currentInfo.features}</p>
                <p><strong>Forces:</strong> ${currentInfo.forceDescription}</p>
            `;
        }

        // Draw force arrow
        function drawArrow(fromX, fromY, toX, toY, color) {
            const headLength = 15;
            const angle = Math.atan2(toY - fromY, toX - fromX);
            
            ctx.beginPath();
            ctx.moveTo(fromX, fromY);
            ctx.lineTo(toX, toY);
            ctx.lineTo(toX - headLength * Math.cos(angle - Math.PI / 6), 
                      toY - headLength * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - headLength * Math.cos(angle + Math.PI / 6),
                      toY - headLength * Math.sin(angle + Math.PI / 6));
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        // Stress point class
        class StressPoint {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.energy = 0;
                this.maxEnergy = 100 + Math.random() * 50;
            }

            update() {
                this.energy += 0.5 + Math.random();
                if (this.energy >= this.maxEnergy) {
                    this.energy = 0;
                    return true; // Trigger earthquake
                }
                return false;
            }

            draw() {
                ctx.font = '20px Arial';
                ctx.fillStyle = colors.stress;
                ctx.fillText('âš¡', this.x, this.y);
                
                // Draw energy bar
                ctx.fillStyle = 'rgba(255, 215, 0, 0.3)';
                ctx.fillRect(this.x + 20, this.y - 10, 
                           (this.energy / this.maxEnergy) * 30, 5);
            }
        }

        // Earthquake class
        class Earthquake {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.radius = 0;
                this.maxRadius = 30 + Math.random() * 20;
                this.alpha = 1;
            }

            update() {
                this.radius += 1;
                this.alpha -= 0.02;
                return this.alpha > 0;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.strokeStyle = `rgba(255, 0, 0, ${this.alpha})`;
                ctx.stroke();
            }
        }

        function drawOceanicContinental() {
            const amplitude = 20;
            const frequency = 0.02;
            
            // Draw water
            ctx.fillStyle = colors.water;
            ctx.fillRect(0, 0, canvas.width, canvas.height/2);

            // Draw continental plate (right side)
            ctx.beginPath();
            ctx.moveTo(canvas.width/2, 0);
            ctx.lineTo(canvas.width, 0);
            ctx.lineTo(canvas.width, canvas.height);
            ctx.lineTo(canvas.width/2, canvas.height);
            ctx.lineTo(canvas.width/2 + 50, canvas.height/2);
            ctx.fillStyle = colors.continentalPlate;
            ctx.fill();

            // Draw oceanic plate (left side)
            ctx.beginPath();
            ctx.moveTo(0, canvas.height/2);
            for(let x = 0; x < canvas.width/2; x++) {
                ctx.lineTo(x, canvas.height/2 + Math.sin(x * frequency + time) * amplitude);
            }
            ctx.lineTo(canvas.width/2, canvas.height);
            ctx.lineTo(0, canvas.height);
            ctx.fillStyle = colors.oceanicPlate;
            ctx.fill();

            // Draw force arrows
            drawArrow(canvas.width/4, canvas.height/2, 
                     canvas.width/2, canvas.height/2 + 50, colors.force);
            drawArrow(canvas.width * 3/4, canvas.height/2,
                     canvas.width/2, canvas.height/2 + 50, colors.force);

            // Add stress points
            if (stressPoints.length < 3 && Math.random() < 0.02) {
                stressPoints.push(new StressPoint(
                    canvas.width/2 - 20 + Math.random() * 40,
                    canvas.height/2 + 50 + Math.random() * 50
                ));
            }
        }

        function drawOceanicOceanic() {
            // Draw water
            ctx.fillStyle = colors.water;
            ctx.fillRect(0, 0, canvas.width, canvas.height/2);

            // Draw plates and forces similar to oceanic-continental
            // but with two oceanic plates
            ctx.beginPath();
            ctx.moveTo(0, canvas.height/2);
            ctx.lineTo(canvas.width/2, canvas.height/2);
            ctx.lineTo(canvas.width/2 + 100, canvas.height);
            ctx.lineTo(0, canvas.height);
            ctx.fillStyle = colors.oceanicPlate;
            ctx.fill();

            // Draw force arrows showing convergence
            drawArrow(canvas.width/4, canvas.height/2,
                     canvas.width/2, canvas.height/2 + 50, colors.force);
            drawArrow(canvas.width * 3/4, canvas.height/2,
                     canvas.width/2, canvas.height/2 + 50, colors.force);

            // Add stress points along subduction zone
            if (stressPoints.length < 4 && Math.random() < 0.02) {
                stressPoints.push(new StressPoint(
                    canvas.width/2 + Math.random() * 100,
                    canvas.height/2 + Math.random() * 100
                ));
            }
        }

        function drawContinentalContinental() {
            // Draw colliding continental plates with compression forces
            ctx.beginPath();
            ctx.moveTo(0, canvas.height/2);
            ctx.lineTo(canvas.width/2 - 50, canvas.height/2);
            ctx.lineTo(canvas.width/2, canvas.height/4);
            ctx.lineTo(canvas.width/2 + 50, canvas.height/2);
            ctx.lineTo(canvas.width, canvas.height/2);
            ctx.lineTo(canvas.width, canvas.height);
            ctx.lineTo(0, canvas.height);
            ctx.fillStyle = colors.continentalPlate;
            ctx.fill();

            // Draw compression forces
            for(let i = 0; i < 3; i++) {
                drawArrow(canvas.width/2 - 100 + i * 50, canvas.height/2 + 50,
                         canvas.width/2 - 100 + i * 50, canvas.height/2 - 20,
                         colors.force);
            }

            // Add stress points along collision zone
            if (stressPoints.length < 5 && Math.random() < 0.02) {
                stressPoints.push(new StressPoint(
                    canvas.width/2 - 50 + Math.random() * 100,
                    canvas.height/2 - 20 + Math.random() * 40
                ));
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            switch(currentType) {
                case 'oceanic-continental':
                    drawOceanicContinental();
                    break;
                case 'oceanic-oceanic':
                    drawOceanicOceanic();
                    break;
                case 'continental-continental':
                    drawContinentalContinental();
                    break;
            }

            // Update and draw stress points
            stressPoints = stressPoints.filter(point => {
                if (point.update()) {
                    earthquakes.push(new Earthquake(point.x, point.y));
                    return false;
                }
                point.draw();
                return true;
            });

            // Update and draw earthquakes
            earthquakes = earthquakes.filter(quake => {
                const active = quake.update();
                if (active) quake.draw();
                return active;
            });

            time += 0.05;
            animationFrame = requestAnimationFrame(animate);
        }

        // Start the simulation
        updateInfo();
        animate();
    </script>
</body>
</html>