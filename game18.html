<!DOCTYPE html>
<html>
<head>
    <title>Geology AR Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Include A-Frame and AR.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.4.2/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ar.js/2.2.2/aframe-ar.min.js"></script>
    <style>
        .ar-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 999;
            padding: 10px 20px;
            background: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    <div id="loading-screen">
        <div style="text-align: center;">
            <h2>Loading AR Experience...</h2>
            <p>Please allow camera access when prompted</p>
        </div>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix;">
        <!-- Rock formation model -->
        <a-box position="0 0.5 0" 
               rotation="0 45 0" 
               material="color: #8B4513"
               scale="1 1 1"
               class="clickable"
               animation="property: rotation; to: 0 405 0; dur: 10000; easing: linear; loop: true">
            <a-box position="0.5 0 0" 
                   scale="0.3 0.8 0.2" 
                   material="color: #A0522D">
            </a-box>
            <a-box position="-0.3 0.2 0.3" 
                   scale="0.2 0.5 0.2" 
                   material="color: #6B4423">
            </a-box>
        </a-box>

        <!-- Marker -->
        <a-marker-camera preset="hiro"></a-marker-camera>
    </a-scene>

    <button class="ar-button" onclick="toggleRotation()">Toggle Rotation</button>

    <script>
        // Hide loading screen when scene is loaded
        document.querySelector('a-scene').addEventListener('loaded', function () {
            document.getElementById('loading-screen').style.display = 'none';
        });

        // Toggle rotation function
        let isRotating = true;
        function toggleRotation() {
            const rock = document.querySelector('a-box');
            if (isRotating) {
                rock.removeAttribute('animation');
            } else {
                rock.setAttribute('animation', 'property: rotation; to: 0 405 0; dur: 10000; easing: linear; loop: true');
            }
            isRotating = !isRotating;
        }

        // Error handling
        window.addEventListener('camera-error', function(e) {
            alert('Camera error. Please ensure you have given camera permissions and try again.');
        });
    </script>
</body>
</html>